<poparser>
	<inputs>
		<field type="Document level">
			<name>ponumber</name><!-- internal label for the scraper script ONLY -->
			<trigger type='raw'>P.O. No.</trigger><!-- label for this field on the excel -->
			<trigger type='raw'>PO No</trigger><!-- label for this field on the excel -->
			<cell>1, 0</cell><!-- where is the actual data associated with this field? provide (x, y) coordinates--> 
			<cell>2, 0</cell><!-- where is the actual data associated with this field? provide (x, y) coordinates--> 
			<cell>3, 0</cell><!-- where is the actual data associated with this field? provide (x, y) coordinates--> 
			<cell>4, 0</cell><!-- where is the actual data associated with this field? provide (x, y) coordinates--> 
			<cell>5, 0</cell><!-- where is the actual data associated with this field? provide (x, y) coordinates--> 
			<cell>6, 0</cell><!-- where is the actual data associated with this field? provide (x, y) coordinates--> 
			<outputfield>PO Number</outputfield> <!--output field name. For many inputs, this will be the Airtable field -->
			<action>Direct Output</action><!-- no processing needed, just scrape the cell and output directly -->
		</field> 
		<field type="Document level">
			<name>issuedate</name>
			<trigger type='raw'>Date</trigger>
			<maxtriggers>1</maxtriggers>
			<cell>1, 0</cell>
			<outputfield>PO Date</outputfield>
			<action>Direct Output</action>
		</field> 
		<field type="Document level">
			<name>deliverydate</name>
			<trigger type='raw'>Delivery</trigger>
			<trigger type='raw'>Targeted Date</trigger>
			<maxtriggers>1</maxtriggers>
			<cell>1, 0</cell>
			<cell>2, 0</cell>
			<cell>3, 0</cell>
			<cell>4, 0</cell>
			<cell>5, 0</cell>
			<checkfunction type='typecheck'>
				<checkif>NOMATCH</checkif>
				<typename>datetime</typename>
				<checkstring>deliveryNotADate </checkstring>
			</checkfunction>
			<outputfield>Delivery Date</outputfield>
			<action>Direct Output</action>
		</field> 
		<field type="Document level">
			<name>project</name>
			<trigger type='raw'>PROJECT</trigger>
			<cell>1, 0</cell>
			<outputfield>Project Site</outputfield>
			<action>Direct Output</action>
		</field> 
		<field type="Document level">
			<name>note</name>
			<trigger type='raw'>**Note</trigger>
			<maxtriggers>1</maxtriggers>
			<cell>1, 0</cell>
			<cell>2, 0</cell>
			<checkfunction type='regex'>
				<regex>\n</regex>
				<!--<regex>^DETAIL.*$</regex>-->
				<checkif>MATCH</checkif>
				<checkstring>noteMultiLine </checkstring>
			</checkfunction>
			<outputfield>Note Raw</outputfield>
			<action>Direct Output</action>
		</field> 
		<field type="Document level">
			<name>detail</name>
			<trigger type='regex'>^DETAIL.+</trigger>
			<maxtriggers>1</maxtriggers>
			<cell>0, 0</cell>
			<cell>1, 0</cell>
			<outputfield>Detail Raw</outputfield>
			<!--<checkfunction type='regex' reportstring='foobar'>.*(?i)Class F(?-i).*</checkfunction>-->
			<checkfunction type='regex'>
				<regex>^.+\n.+$</regex>
				<!--<regex>^DETAIL.*$</regex>-->
				<checkif>MATCH</checkif>
				<checkstring>detailMultiLine </checkstring>
			</checkfunction>
			<checkfunction type='regex'>
				<regex>(?i)(.|\n)+?(class|cl)(.|\n)+?(class|cl)(.|\n)+?$</regex>
				<checkif>MATCH</checkif>
				<checkstring>detailMultiClass </checkstring>
			</checkfunction>
			<checkfunction type='regex'>
				<regex>(?i)(.|\n)+?(series)(.|\n)+?(series)(.|\n)+?$</regex>
				<checkif>MATCH</checkif>
				<checkstring>detailMultiSeries </checkstring>
			</checkfunction>
			<action>Direct Output</action>
		</field> 
		<field type="Document level">
			<name>galvanised</name>
			<trigger type='raw'>Galvanised</trigger>
			<maxtriggers>1</maxtriggers>
			<cell>1, 0</cell>
			<outputfield>Galvanised</outputfield>
			<action>Direct Output</action>
		</field> 
		<field type="Document level">
			<name>urgentreason</name>
			<trigger type='raw'>Reason</trigger>
			<cell>1, 0</cell>
			<outputfield>Reason</outputfield>
			<action>Direct Output</action>
		</field> 
		<field type="Table">
			<name>maintable</name>
			<maxtriggers>1</maxtriggers>
			<trigger type='raw'>s/n</trigger>
			<checkfunction type='regex'>
				<header>(?i)(item).*</header>
				<regex>(?i)([A-Z])\d</regex> <!--search for 'A1', 'B2' etc-->
				<checkif>MATCH</checkif>
				<checkstring>multiTypeItem </checkstring>
			</checkfunction>
			<checkfunction type='regex'>
				<header>(?i)model.*</header>
				<regex>(?i).*mml.*mml.*</regex>
				<checkif>MATCH</checkif>
				<checkstring>multimmL</checkstring>
			</checkfunction>
			<checkfunction type='regex'>
				<header>.*</header>
				<regex>\n</regex>
				<checkif>MATCH</checkif>
				<checkstring>linebreak </checkstring>
			</checkfunction>
			<action>Parse Table</action>
			<tablefield>
				ITEM
				<name></name>
			</tablefield>
		</field> 
	</inputs>
</poparser>
